<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">
        <link rel="stylesheet" href="css/mine.css">
        
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section>
                        <h1>Spring Boot</h1>
                        <img src="https://atomrace.com/blog/wp-content/uploads/2018/05/spring-boot-logo.png" alt="">
                </section>
                <section>
                    <section>
                        <h3>Le d√©veloppement web en java</h3>
                        <p>Complexit√© de la pile applicative</p>
                        <ul>
                            <li>Le mod√®le MVC</li>
                            <li>La gestion de la s√©curit√©</li>
                            <li>L'acc√®s aux donn√©es (SQL, NoSQL)</li>
                            <li>Service cloud</li>
                            <li>Code boilerplate sans "valeur"</li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Meet Spring</h3>
                        <ul>
                            <li>Un framework open source java largement utilis√© dans le d√©veloppement java</li>
                            <li>Un √©cosyst√®me Spring complet</li>
                            <li>Impl√©mente l'injection de d√©pendances</li>
                            <li>Gain de temps via configurations et annotations</li>
                        </ul>
                    </section>

                    <section>
                        <h3>üçÉHands-on 1 : initialiser un projet Spring Boot</h3>
                        <ol>
                            <li>Allez sur https://start.spring.io/ cr√©ez un projet spring boot.</li>
                            <li>Lancez le main voir que le code fonctionne.</li>
                        </ol>
                    </section>

                    <section>
                        <h3>Anatomie du code minimal</h3>
                        <ul>
                            <li>Fichiers maven : pom.xml, mvnm, mvnm.cmd</li>
                            <li>Les packages classiques
                                <ul>
                                    <li>src/main/java : java</li>
                                    <li>src/main/resources : properties/template</li>
                                    <li>src/test/java : test</li>
                                </ul>
                                </li>
                        </ul>
                    </section>

                    <section>
                        <h3>Anatomie du code minimal</h3>
                        <pre><code data-trim data-noescape class="language-java">
package fr.ensai.demo;

@SpringBootApplication
public class DemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

}
                        </code></pre>
                    </section>
                    <section>
                        <h3>Les annotations</h3>
                        <ul>
                            <li>Permet de modifier le comportement d'une
                                classe ou m√©thode</li>
                            <li>@SpringBootApplication = 
                                <ul>
                                    <li>@SpringBootConfiguration : la classe sera utilis√©e comme une classe de configuration.</li>
                                    <li>@EnableAutoConfiguration : active la fameuse fonctionnalit√© d‚Äôautoconfiguration de Spring Boot.</li>
                                    <li>@ComponentScan : active le ‚Äúscanning‚Äù de classes dans le package de la classe et dans ses sous-packages.</li>
                                </ul>
                            </li>
                            <li>Spring en utilise beaucoup mais ce n'est pas une propre √† Spring</li>
                            <li>Equivalent en python, decorator (!= du pattern)</li>
                    </section>

                    <section>
                        <h3>Les annotations</h3>

                        <ul>
                            <li>@Component : d√©fini un bean Spring</li>
                            <li>@Qualifier : permet de nommer notre bean</li>
                            <li>@Autowired : permet d'appeler un bean</li>
                            <li>@SpringBootApplication : d√©fini une application Spring Boot</li>
                            <li>D'autres dans le futur</li>
                        </ul>
                    </section>

                    <section>
                        <h3>üçÉHands-on 2 : Un premier hello world </h3>
                        <ol>
                            <li>Cr√©ez une classe HelloWorldService qui impl√©mente 
                                l'interface CommandLineRunner, et surchargez la m√©thode
                                √† impl√©menter pour afficher un hello world </li>
                            <li>Faites de cette classe un beans Spring</li>
                            <li>Lancez votre application</li>
                            <li>Que se passe-t-il ?</li>
                        </ol>
                    </section>

                    <section>
                        <h3>IoC container/ Application Context</h3>
                        <ul>
                            <li>La fonctionnalit√© principale de Spring</li>
                            <li>Permet de d√©coupler la cr√©ation de l'utilisation (proche de la factory)</li>
                            <li>Code plus √©volutif</li>
                            <li>Se base sur les abstractions</li>
                            <li>Faible couplage</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Injection de d√©pendances 1</h3>
                        <pre><code data-trim data-noescape class="language-java">
public class Command {
    private Product product;

    public Command() {
        this.product = new Product(‚Äúsomething‚Äù);
    }
}
                        </code></pre>
                    </section>
                    <section>
                        <h3>Injection de d√©pendances 2</h3>
                        <pre><code data-trim data-noescape class="language-java">
public class Command (
    private Product product;
    public Product getProduct() {
        return product;
    }
    public void setProduct(Product product) { 
    // Passage de produit en param√®tre, peu √™tre une ss classe
        this.product = product;
    )
    public Command() { } // Constructeur plus l√©ger
}
                        </code></pre>
                    </section>
                    <section>
                        <h3>Bilan</h3>
                        <ul>
                            <li>Disparition du new Product</li>
                            <li>Command doit recevoir un produit</li>
                            <li>D√©l√©gation √† une tierce partie (factory)</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Injection de d√©pendances en Spring</h3>
                        <ul>
                            <li>IoC Container</li>
                            <li>Annotation @Component pour les beans</li>
                            <li>Annotation @Autowired pour les utilisateurs des beans</li>
                        </ul>
                    </section>

                    <section>
                        <pre><code data-trim data-noescape class="language-java">
@Component
public class FirstBean {
    public String toString (){
        return "Hello world"
    };
}
                        </code></pre>
                            <pre><code data-trim data-noescape class="language-java">
@SpringBootApplication
public class DemoApplication {
    @Autowired
    private FirstBean firstBean;
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
        System.out.println(firstBean);
    }

}
                        </code></pre>
                    </section>

                    <section>
                        <h3>üçÉHands-on 3 : mes premiers beans</h3>
                        <ol>
                            <li>Cr√©ez une classe BookService qui contient une liste de livre.
                                La classe BookService est un bean spring.
                            </li>
                            <li>Cr√©ez une classe LibraryService. La classe LibraryService
                                est un bean spring avec un attribut nom.
                            </li>
                            <li>Affichez les informations de vos beans.</li>
                            <li>Est-ce que vos beans sont des singletons ?</li>
                        </ol>
                    </section>
                    </section>


                    <section>
                        <section>
                            <h2>Faire un webservice avec SpringBoot</h2>
                        </section>

                        <section>
                            <h3>Les starters Spring Boot</h3>
                            <ul>
                                <li>Collection de d√©pendances qui ont un but commun</li>
                                <li>Plus besoin de partir √† le recherche des d√©pendances</li>
                            </ul>
                            <pre><code data-trim class="language-xml">
                                <dependency>
                                    <groupId>org.springframework.boot</groupId>
                                    <artifactId>spring-boot-starter-web</artifactId>
                                </dependency>
                            </code></pre>
                        </section>

                        <section>
                            <h3>D√©finir des endpoints avec Spring</h3>
                            <pre><code data-trim class="language-java">
                                    @RestController
                                    @RequestMapping("/hello")
                                    public class HelloWorldController {
                                        @GetMapping("/world")
                                        public String helloWorld() {
                                            return "Hello world";
                                        }
                                    }
                            </code></pre>
                        </section>

                        <section>
                            <h3>D√©finir des endpoints avec Spring</h3>
                            <ul>
                                <li>@RestController : bean pour une API Rest</li>
                                <li>@RequestMapping("") : pr√©fixe des endpoints de la classe</li>
                                <li>@GetMapping("") : d√©finition d'un endpoint get</li>
                                <li>@PostMapping, @PatchMapping, @PutMapping, @DeleteMapping : les autres m√©thodes</li>
                                <li>Spring s√©rialise la r√©ponse automatiquement (besoin de getter)</li>
                            </ul>
                        </section>

                        <section>
                            <h3>üçÉHands-on 4 : mon premier endpoint</h3>
                            <ol>
                                <li>Allez sur https://start.spring.io/ et cr√©ez un projet spring boot.</li>
                                <li>Prenez les starter web, h2, postgres et JPA</li>
                                <li>Cr√©ez les packages services, model, controller</li>
                                <li>Cr√©ez une classe Book avec les attributs titre, auteur et √©diteur</li>
                                <li>Cr√©ez une classe BookService avec une m√©thode getBooks qui retourne
                                    une liste de livre. Vous pouvez la hardcoder pour le moment
                                </li>
                                <li>Cr√©ez un classe LivreController qui expose un endpoints getBooks
                                    qui retourne une liste de livre
                                </li>
                            </ol>
                        </section>
    
                        <section>
                            <h2>Communication avec une BDD üíæ</h2>
                            <em>Ou comment rendre trivial le projet de 2A</em>
                        </section>

                        <section>
                            <h3>La notion d'ORM</h3>
                            <ul>
                                <li>Faire le lien entre base de donn√© et code est laborieux</li>
                                <li>Hibernate : Outils g√©n√©rique pour faire le lien pojo-bdd utilis√© par Spring</li>
                            </ul>
                        </section>

                        <section>
                            <h3>Lien entre un objet et une table</h3>

                            <pre><code data-trim class="language-java">
                                    @Entity
                                    @Table(name = "employees")
                                    public class Employee {
                                    
                                        @Id
                                        @GeneratedValue(strategy = GenerationType.IDENTITY)
                                        private Long id;
                                    
                                        @Column(name="first_name")
                                        private String firstName;
                                    
                                        @Column(name="last_name")
                                        private String lastName;
                                    
                                        private String mail;
                                    
                                        private String password;
                                    
                                    }
                            </code></pre>
                        </section>

                        <section>
                            <h3>Lien entre un objet et une table</h3>
                            <ul>
                                <li>Se base sur des annotations</li>
                                <li>@Entity : annotation pour dire que cet objet est li√© √† une base</li>
                                <li>@Table(name = "employees") : nom de la table si diff√©rent nom classe</li>
                                <li>@Column(name="first_name") : nom de la colonne de la table si diff√©rent attribut</li>
                                <li>@Id : cette colonne est une primary key</li>
                                <li>@GeneratedValue(strategy = GenerationType.IDENTITY) : c'est la base qui g√®re la clef primaire</li>
                            </ul>
                        </section>

                        <section>
                            <h3>Cr√©ation des DAO en 1min</h3>
                            <ul>
                                <li>On a maintenant quelque chose qui repr√©sente une ligne</li>
                                <li>Besoin de m√©thodes pour requ√™ter notre table</li>
                                <li>Interface CrudRepository &lt entity, ID &gt + annotation @Repository</li>
                            </ul>
                        </section>

                        <section>
                            <h3>Cr√©ation des DAO en 1min</h3>
                            <pre><code data-trim class="language-java">
                                @Repository
                                public interface EmployeRepository extends CrudRepository &lt Employee, Long &gt {
                                }
                        </code></pre>
                        <p>Pour un CRUD de base pas besoin de plus de code !!!</p>
                        </section>

                        <section>
                            <h3>L'interface CrudRepository</h3>
                            <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html">doc officielle</a>

                        </section>

                        <section>
                            <pre><code data-trim class="language-java">
                                @Service
                                public class EmployeeService {
                                
                                    @Autowired
                                    private EmployeRepository employeRepository;
                                
                                    public Optional&ltEmployee&gt getEmployee(final Long id) {
                                        return employeRepository.findById(id);
                                    }
                                
                                    public Iterable&ltEmployee&gt getEmployees() {
                                        return employeRepository.findAll();
                                    }
                                
                                    public void deleteEmployee(final Long id) {
                                        employeRepository.deleteById(id);
                                    }
                                
                                    public Employee saveEmployee(Employee employee) {
                                        Employee savedEmployee = employeRepository.save(employee);
                                        return savedEmployee;
                                    }
                                }
                        </code></pre>
                        </section>

                        <section>
                            <h3>Comment Spring Boot conna√Æt la base ?</h3>
                            <ul>
                                <li>Autoconfiguration de SpringBoot</li>
                                <li>Fichier application.properties</li>
                            </ul>
                            <pre><code data-trim>
                                #H2 Database configuration
                                database=h2
                                spring.datasource.schema=classpath*:schema.sql
                                spring.datasource.data=classpath*:data.sql
                        </code></pre>

                        <p><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#data.sql.datasource.configuration">
                            Doc officielle
                        </a></p>
                        </section>


                        <section>
                            <h3>üçÉHands-on 5 : un webservice CRUD</h3>
                            <ol>
                                <li>Transformer la classe Book en Entity</li>
                                <li>Cr√©ez une classe BookReposiory qui impl√©mente CrudRepository</li>
                                <li>Book service impl√©mente un CRUD</li>
                                <li>BookController impl√©mente les bons endpoints
                                </li>
                                <li>Utilisez une base h2 pour stockez vos donn√©es</li>
                                <li>Quand vous avez termin√© transformer la base h2 en base postgres</li>
                            </ol>
                        </section>
    
                    </section>
                </section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
                height: 1080,
                width: 1920,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
