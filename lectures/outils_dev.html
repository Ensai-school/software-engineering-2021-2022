<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>üß∞ Outils de dev</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">
        <link rel="stylesheet" href="css/mine.css">
        
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">                
                <section>
                    <section>
                        <h1>Les outils pour √©crire du bon code üß∞</h1>
                    </section>
                    <section>
                        <h3>Overview</h3>
                        <ul>
                            <li>Packager son code : maven (java), buildout(python)</li>
                            <li>Test : Junit4/5 (java), pytest(python)</li>
                            <li>Logging : log4j (java), logger(python)</li>
                            <li>Bonnes pratiques de code</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Packager son code üì¶</h2>
                    </section>

                    <section>
                        <h3>Packager en ligne de commande</h3>
                        <ul>
                            <li>Source code : votre code (vivant), fortement d√©pendant de votre environnement de travail</li>
                            <li>Code packager : code non modifiable (ex compil√©) fait pour √™tre ex√©cut√©</li>
                            <li>Beaucoup d'IDE font √ßa pour nous</li>
                            <li>Mais avec le conteneurisation, CI/CD, cloud computing, besoin
                                de savoir faire √ßa √† la main.
                            </li>
                            <li>Besoin juste de faire la diff√©rence entre langage n√©cessitant une 
                                compilation (Java, C, Kotlin, C#) et les interpr√©t√©s (python, js)
                            </li>
                        </ul>
                    </section>

                    <section>
                        <h3>Historique</h3>
                        <ul>
                            <li>Dans les ann√©es 70 : compilation des programmes de plus en plus
                                 longue et complexe (plusieurs fichiers, commandes, interd√©pendance)</li>
                            <li>Make pour automatiser la compilation, fichier makefile avec 
                                toutes les commandes, facile √† partager et r√©utiliser</li>
                            <li>Java : langage compil√©, diff√©rentes versions,
                                de d√©pendances externe etc 
                            </li>
                            <li>Maven : rempla√ßant de Make pour java</li>
                        </ul>
                    </section>

                    <section>
                        <h3>C'est quoi Maven</h3>
                        <ul>
                            <li>‚õΩUn outil de gestion des d√©pendances</li>
                            <li>üöÄUn outil de build + d√©ploiement</li>
                            <li>üìöUn outil de documentation</li>
                        </ul>
                        <p>Pas d'√©quivalent en python (et c'est bien dommage)</p>
                    </section>

                    <section>
                        <h3>Les objectifs</h3>
                        <ul>
                            <li>Rendre transparentes les t√¢ches de build (cycle de vie maven)</li>
                            <li>Uniformisation des outils (plugin maven, ligne de commande)</li>
                            <li>Standardisation des pratiques de dev (convention over configuration)</li>
                            <li>Limiter le temps de formation des juniors</li>
                            <li>Limiter l'impact de l'h√©t√©rog√©n√©it√© des configs personnelles</li>
                            <li>Se concentre sur l'√©criture de code</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Un monde sans Maven (ou √©quivalent) üî•üëø</h3>
                        <ul>
                            <li>Importer √† la main les d√©pendances (pensez pip et le projet 2A)</li>
                            <li>Devoir compiler √† la main son application (merci les IDE de faire √ßa pour nous üíñ)</li>
                            <li>Incompatibilit√©s possibles en fonction des versions de java install√©es</li>
                            <li>Customisation du process de build/d√©ploiement difficile</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Cycle de vie java : compilation/ex√©cution</h3>
                        <ul>
                            <li>Java est un langage qui doit √™tre compil√© en bytecode puis
                                interpr√©t√© par la JVM
                            </li>
                            <li>Besoin de deux instructions
                                <ol>
                                    <li>Compilation : javac</li>
                                    <li>Ex√©cution : java</li>
                                </ol>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <h3>Cycle de vie java : d√©pendances externes</h3>
                        <ul>
                            <li>Un projet √† souvent des d√©pendances externes üß≥</li>
                            <li>Mais elles sont d√©j√† compil√©es (.jar) üì¶</li>
                            <li>Donc ne peuvent pas l'√™tre √† nouveau ü§î</li>
                            <li>Mais sont n√©cessaire pour l'application üò±</li>
                            <li>Besoin d'ajouter ces d√©pendance au classpath</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Classpath</h3>
                        <cite>
                            Classpath est un param√®tre pass√© √† une machine virtuelle Java
                            qui d√©finit le chemin d'acc√®s au r√©pertoire o√π se trouvent les
                            classes et les packages Java afin qu'elle les ex√©cute.

                            Au sein de la machine virtuelle, c'est le chargeur de classe
                            qui parcourt les r√©pertoires sp√©cifi√©s par le classpath pour
                            trouver o√π sont install√©es les classes requises par un programme Java. 
                        </cite>
                    </section>
                    <section>
                        <h3>Cycle de vie java : jar</h3>
                        <ul>
                            <li>Pas toujours √©vident de livrer une application
                                contenant plusieurs centaines de fichiers .java
                                et des d√©pendances externes
                            </li>
                            <li>Besoin de packager tout √ßa</li>
                            <li>Deux grand format : jar, war</li>
                            <li>Basiquement des archives de fichiers avec des metadata
                            </li>
                            <li>Dans le cas d'un jar les metadata sont dans un fichier
                                MANIFEST.MF
                            </li>
                        </ul>
                        <pre style="width: 100%;"><code data-trim data-noescape class="language-txt">
Manifest-Version: 1.0
Main-Class: ClassWithMainMethod
Class-Path: useful jars
                        </code></pre>
                    </section>
                    <section>
                        <h3>Cycle de vie java</h3>
                        <ol>
                            <li>Ecriture de code</li>
                            <li>Compilation du code :<pre style="width: 100%;"><code data-trim data-noescape class="language-shell">
javac [-cp external jars] [file1, file2...]
                                </code></pre> </li>
                            <li>Lancer le code : 
                                <pre style="width: 100%;"><code data-trim data-noescape class="language-shell">
java [-cp external jars] [main file] 
                            </code></pre> </li>
                            <li>Cr√©ation d'un jar : 
                                <pre style="width: 100%;"><code data-trim data-noescape class="language-shell">
jar cmf [path.to.MANIFEST] [file1.class, file2.class]/[*.class]
                            </code></pre> </li>
                            <li>Lancer un jar : 
                                <pre style="width: 100%;"><code data-trim data-noescape class="language-shell">
java jar [path.to.jar]
                            </code></pre> </li>
                        </ol>
                    </section>

                    <section>
                        <h3>Hands-on 1.1 ‚òï: une classe basique</h3>
                        <ul>
                            <li>Cr√©ez une class App avec un main qui print un hello world</li>
                            <li>Compilez cette classe via le terminal</li>
                            <li>Lancez l√†</li>
                            <li>Faites-en un jar ex√©cutable (internet est votre ami)</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Hands-on 1.2 ‚òï: d√©pendances externes</h3>
                        <ul>
                            <li>R√©cup√©rez le code sur Moodle</li>
                            <li>Compilez les classes</li>
                            <li>Lancez App.class</li>
                            <li>Faites-en un jar ex√©cutable et lancez le</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Meet Maven üê¶</h3>
                        Apache Maven is a <span class="important">software project management
                        and comprehension tool</span>.
                        Based on the concept of <span class="important">a project object model (POM)</span>
                        , Maven can manage a <span class="important">project's build, reporting and documentation</span>
                        from a <span class="important">central piece of information</span>.
                    </section>

                    <section>
                        <h3>G√©n√©rer un projet maven</h3>
                        <ol>
                            <li>V√©rifier que vous avez maven d'install√©</li>
                            <li>
                                <pre style="width: 100%;"><code data-trim data-noescape class="language-shell">
mvn -B archetype:generate   -DgroupId=com.mycompany.app 
                            -DartifactId=my-app 
                            -DarchetypeArtifactId=maven-archetype-quickstart 
                            -DarchetypeVersion=1.4
                                </code></pre>
                            </li>
                            <li>
                                G√©n√®re un pom.xml basique et l'arborescence classique maven
                                <pre style="width: 100%;"><code data-trim data-noescape class="language-shell">
                                    project
                                    |-- pom.xml
                                    `-- src
                                        |-- main
                                        |   `-- java
                                        |       `-- $package
                                        |           `-- App.java
                                        |-- site
                                        |   `-- site.xml
                                        `-- test
                                            `-- java
                                                `-- $package
                                                    `-- AppTest.java
                               </code></pre>
                            </li>
                        </ol>

                    </section>

                    <section>
                        <h3>Cycle de vie Maven</h3>
                        <ol>
                            <li>validate - validate the project is correct and all necessary information is available</li>
                            <li>compile - compile the source code of the project</li>
                            <li>test - test the compiled source code using a suitable unit testing framework. These tests should not require the code be packaged or deployed</li>
                            <li>package - take the compiled code and package it in its distributable format, such as a JAR.</li>
                            <li>verify - run any checks on results of integration tests to ensure quality criteria are met</li>
                            <li>install - install the package into the local repository, for use as a dependency in other projects locally</li>
                            <li>deploy - done in the build environment, copies the final package to the remote repository for sharing with other developers and projects.</li>
                        </ol>
                        <ul>
                            <li>clean : cleans up artifact created by prior builds</li>
                            <li>site : generates site documentation for this project</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Cycle de vie Maven</h3>
                        <ul>
                            <li>Pour build un projet : mvn package</li>
                            <li>Pour d√©ployer : mvn deploy</li>
                            <li>Pour g√©n√©rer un site documentation : mvn site</li>
                            <li>Plus g√©n√©ralement : mvn build phase[:plugin goal]</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Le Project Object Model (POM.xml) üçé</h3>
                        <p>Contient</p>
                        <ul>
                            <li>Les metadata du projet : nom, version, contributor</li>
                            <li>Version de java √† utiliser</li>
                            <li>Comment il faut le packager : war / jar</li>
                            <li>Les d√©pendances : biblioth√®ques externes</li>
                            <li>Comment il faut le builder</li>
                        </ul>

                        <div class="important">Contient toutes les informations pour faire fonctionner votre projet</div>
                    </section>


                    <section>
                        <h3>Exemple de POM</h3>
                        <pre><code data-trim class="language-xml">
                            <project>
                                <modelVersion>4.0.0</modelVersion>
                               
                                <groupId>fr.ensai.app</groupId>
                                <artifactId>my-app</artifactId>
                                <version>1</version>

                                <properties>
                                    <maven.compiler.source>1.8</maven.compiler.source>
                                    <maven.compiler.target>1.8</maven.compiler.target>
                                </properties>

                                <dependencies>
                                    <dependency>
                                      <groupId>junit</groupId>
                                      <artifactId>junit</artifactId>
                                      <version>4.12</version>
                                      <type>jar</type>
                                      <scope>test</scope>
                                      <optional>true</optional>
                                    </dependency>
                                </dependencies>

                              </project>
                        </code></pre>
                    </section>

                    <section>
                        <h3>Options de build</h3>
                        <pre><code data-trim class="language-xml">
                            <project>
                                <modelVersion>4.0.0</modelVersion>
                               
                                <groupId>fr.ensai.app</groupId>
                                <artifactId>my-app</artifactId>
                                <version>1</version>
                                ...
                                <build>
                                    <plugins>
                                        <plugin>
                                            <groupId>org.apache.maven.plugins</groupId>
                                            <artifactId>maven-assembly-plugin</artifactId>
                                
                                            <configuration>
                                                <descriptorRefs>
                                                    <descriptorRef>jar-with-dependencies</descriptorRef>
                                                </descriptorRefs>
                                                <archive>
                                                    <manifest>
                                                        <mainClass>path.to.Main.class</mainClass>
                                                    </manifest>
                                                </archive>
                                            </configuration>
                                
                                            <executions>
                                                <execution>
                                                    <id>make-assembly</id>
                                                    <phase>package</phase>
                                                    <goals>
                                                        <goal>single</goal>
                                                    </goals>
                                                </execution>
                                            </executions>
                                        </plugin>
                                    </plugins>
                                </build>

                              </project>
                        </code></pre>
                    </section>

                    <section>
                        <h3>Hands-on 2 üê¶: Maven</h3>
                        <ol>
                            <li>Reprenez le code de l'exercice pr√©c√©dent</li>
                            <li>Cr√©ez un POM.xml pour <em>maveniser</em> votre application</li>
                            <li>Pensez √† ajouter la d√©pendance Apache Commons Collections (go internet)</li>
                            <li>Compilez votre application avec maven</li>
                        </ol>
                    </section>

                    <section>
                        <h3>Wrapper maven</h3>
                        <ul>
                            <li>Maven permet de g√©rer la version java</li>
                            <li>Mais qui g√®re la version de maven ?</li>
                            <li>Wrapper maven : plugin maven qui permet de livrer un 
                                script qui encapsule maven
                            </li>
                            <li>Ce script n'a pas besoin d'avoir maven d'installer
                                pour fonctionner
                            </li>
                            <li>Il permet de s'assurer que deux personnes qui lance
                                le script obtiennent le m√™me r√©sultat
                            </li>
                        </ul>
                    </section>

                    <section>
                        <h3>Wrapper maven :  les commandes</h3>
                        <ol>
                            <li>Cr√©er un fichier .mvnw <pre><code data-trim class="language-bash">
                                mvn wrapper:wrapper
                            </code></pre></li>
                            <li>Utiliser maven depuis un wrapper maven <pre><code data-trim class="language-bash">
                                # Unix
                                ./mvnw clean install
                                # Windows
                                mvnw.cmd clean install
                            </code></pre></li>
                        </ol>
                    </section>

                    <section>
                        <h3>Hands-on 2.1 üì¶üê¶: Wrapper Maven</h3>
                        <ol>
                            <li>Reprenez le code de l'exercice pr√©c√©dent</li>
                            <li>Cr√©ez un wrapper maven pour le code </li>
                            <li>Faites un clean install en utilisant le wrapper</li>
                        </ol>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Les tests</h2>
    
                        <p class="no-print"><a href="http://www.commitstrip.com/fr/2017/02/08/where-are-the-tests/"><img src="https://www.commitstrip.com/wp-content/uploads/2017/02/Strip-Ou-sont-les-tests-unitaires-650-final.jpg"
                                    alt="tester c'est douter" class="plain w50"></a><br>Source : commitstrip <a href="http://www.commitstrip.com/fr/2017/02/08/where-are-the-tests/">Lien</a>
                    </section>

    
                    <section>
                        <h3>D√©finition</h3>
                        <blockquote cite="https://fr.wikipedia.org/wiki/Test_(informatique)" class="w95 ftsz80">
                            &ldquo;En informatique, un test d√©signe une proc√©dure de <span class="important">v√©rification partielle</span>
                            d'un syst√®me. Son objectif principal est <span class="important">d'identifier un nombre maximum de
                                comportements probl√©matiques</span>
                            du logiciel. Il permet ainsi, d√®s lors que les <span class="important">probl√®mes identifi√©s seront
                                corrig√©s, d'en augmenter la qualit√©.</span>
                            <br>
                            <br> D'une mani√®re plus g√©n√©rale, le test d√©signe <span class="important">toutes les activit√©s qui
                                consistent √† rechercher des informations quant √† la qualit√© du syst√®me afin de permettre la prise
                                de d√©cisions.</span>
                            <br>
                            <br> Un test ressemble √† une <span class="important">exp√©rience scientifique</span>. Il examine une
                            hypoth√®se exprim√©e en fonction de trois √©l√©ments : <span class="important">les donn√©es en entr√©e,
                                l'objet √† tester et les observations attendues</span>. Cet examen est effectu√© sous conditions
                            contr√¥l√©es pour pouvoir tirer des conclusions et, dans l'id√©al, <span class="important">√™tre reproduit
                            </span>&rdquo;
                        </blockquote>
    
    
                    </section>
    
                    <section>
                        <h3>En r√©sum√©</h3>
                        <ul>
                            <li class="fragment">Aucun test n'est parfait !</li>
                            <li class="fragment">Donne seulement une information partielle de la qualit√© de votre application</li>
                            <li class="fragment">Permet de d√©tecter des "erreurs"</li>
                            <li class="fragment">Et de les corriger si vous √™tes conciencieux</li>
                            <li class="fragment">Il y en a plusieurs types</li>
                            <li class="fragment"> <span class="fragment highlight-important">Et ils doivent √™tre reproductibles
                                    !</span></li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Pourquoi en tant que dev ?</h3>
                        <ul>
                            <li class="fragment">V√©rifier que notre code fait ce qu'il doit faire</li>
                            <li class="fragment">√âviter les r√©gressions quand on modifie le code</li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Quoi tester dans une application ?</h3>
                        <ul class="fragment">
                            <li>Les fonctions unitairement</li>
                            <li>Les modules entre eux</li>
                            <li>Les use case en entier</li>
                            <li>La navigation dans l'ihm</li>
                            <li>La r√©sistance au nombre d'utilisateur</li>
                            <li>La r√©sistance aux intrusions</li>
                            <li>...</li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Les tests associ√©s</h3>
                        <ul>
                            <li><span class="fragment highlight-important">Tests unitaires</span></li>
                            <li>Tests d'int√©gration</li>
                            <li>Tests fonctionnels</li>
                            <li>Tests d'IHM</li>
                            <li>Tests de charge</li>
                            <li>Test d'intrusion</li>
                        </ul>
                    </section>
    
    
                    <section>
                        <h3>Quand tester ?</h3>
    
                        <iframe src="https://giphy.com/embed/2xF8ihOYNJCG0iAXNU" width="1500" height="570" frameBorder="0" class="no-print giphy-embed" allowFullScreen></iframe>
                    </section>
    
                    <section>
                        <h3>Quand tester ?</h3>
                        <div class="important-bloc">Au d√©but !!!!!</div>
                        <p class="fragment">Plus on teste t√¥t et plus les tests sont efficaces et peu co√ªteux !</p>
                    </section>
    
                    <section>
                        <h3>Le Test Driven Development (TDD)</h3>
                        <p class="fragment">Pratique qui consiste √† √©crire les tests <span class="important">AVANT</span> de
                            coder</p>
                        <ul>
                            <li class="fragment">On commence par √©crire un test (inputs, objet √† tester,outputs)</li>
                            <li class="fragment">Puis on d√©finit les fonctions n√©cessaires pour lancer le test</li>
                            <li class="fragment">On lance le test -> <span class="red">echec</span></li>
                            <li class="fragment">On code la fonction pour une r√©ussite minimal -> <span class="green">r√©ussite</span></li>
                            <li class="fragment">On met √† jour la fonctions -> <span class="purple">refactor</span></li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Le Test Driven Development (TDD)</h3>
                        <p><a href="https://commons.wikimedia.org/wiki/File:Cycle-global-tdd.png#/media/Fichier:Cycle-global-tdd.png"><img
                                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Cycle-global-tdd.png/1200px-Cycle-global-tdd.png"
                                    alt="Cycle global TDD" class="plain w60"></a><br>Par Xarawn ‚Äî <span class="int-own-work" lang="fr">Travail
                                personnel
                            </span>,
                            <a href="https://creativecommons.org/licenses/by-sa/4.0" title="Creative Commons Attribution-Share Alike 4.0">CC
                                BY-SA 4.0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=44782737">Lien</a></p>
                    </section>
    
                    <section>
                        <h3>Avantages du TDD</h3>
                        <ul>
                            <li class="fragment">Grande quantit√© de tests</li>
                            <li class="fragment">Rassurant</li>
                            <li class="fragment">Limite le code inutile</li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Inconv√©nients du TDD</h3>
                        <ul>
                            <li class="fgrament">Beaucoup de temps √† faire des tests</li>
                            <li class="fgrament">Il faut maintenir les tests</li>
                        </ul>
                        <div class="important-bloc fragment">Avantages >>>> Inconvenients</div>
                    </section>
    
    
                    <section>
                        <h2>Les tests unitaires</h2>
                    </section>
    
                    <section>
                        <h3>Les tests unitaires</h3>
                        <ul>
                            <li class="fragment">V√©rifie qu'une m√©thode fait bien ce qu'elle doit faire</li>
                            <li class="fragment">Cas nominaux (doivent fonctionner)</li>
                            <li class="fragment">Cas d'erreur (doivent lever une erreur)</li>
                            <li class="fragment">Cas √† la marge (√ßa d√©pend)</li>
                            <li class="fragment">Tests √† la charge des d√©veloppeurs</li>
                        </ul>
                    </section>
    
                    <section>
                       <h3>Junit5</h3>
                       <ul>
                           <li>Le framework de test le plus r√©cent en java</li>
                           <li>Besoin de l'ajouter aux d√©pendances du projet (dans le pom)</li>
                           <li>G√©n√©ralement les tests sont dans le dossier test</li>
                           <li>Utilisation d'annotations</li>
                       </ul>
                    </section>

                    <section>
                        <h3>Ajouter Junit5 √† votre projet</h3>
                        <pre><code data-trim class="language-xml">
                            <dependency>
                                <groupId>org.junit.jupiter</groupId>
                                <artifactId>junit-jupiter</artifactId>
                                <version>5.4.0</version>
                                <scope>test</scope>
                            </dependency>
                        </code></pre>
                    </section>

                    <section>
                        <pre><code data-trim class="language-java">
                            class StandardTests {
                                @BeforeAll
                                static void initAll() {
                                }
                                @BeforeEach
                                void init() {
                                }
                                @Test
                                void succeedingTest() {
                                }
                                @Test
                                void failingTest() {
                                    fail("a failing test");
                                }
                                @Test
                                @Disabled("for demonstration purposes")
                                void skippedTest() {
                                    // not executed
                                }
                                @Test
                                void abortedTest() {
                                    assumeTrue("abc".contains("Z"));
                                    fail("test should have been aborted");
                                }
                                @AfterEach
                                void tearDown() {
                                }
                                @AfterAll
                                static void tearDownAll() {
                                }   
                            }
                        </code></pre>   
                    </section>

                    <section>
                        <h3>Anatomie d'un test</h3>
                        <p>Deux structures courantes et √©quivalentes</p>
                        <ul>
                            <li>GIVEN WHEN THEN</li>
                            <li>ARRANGE ACT ASSERT</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Anatomie d'un test</h3>
                        <ol>
                            <li>D√©finition et mise en forme des inputs (GIVEN/ARRANGE)</li>
                            <li>R√©alisation des actions que l'on souhaite tester (WHEN/ACT)</li>
                            <li>V√©rification des assertions (THEN/ASSERT)</li>
                        </ol>
                    </section>

                    <section>
                        <pre><code data-trim class="language-java">
                            class StandardTests {
                                @Test
                                void dummyTest() {
                                    // GIVEN
                                    int integer1 = 1;
                                    int integer2 = 3
                                    // WHEN
                                    int sum = integer1+integer2
                                    // THEN
                                    assertEquals(4, sum)
                                }
                            }
                        </code></pre>

                        <pre><code data-trim class="language-java">
                            @Test
                            public void addTopping() {
                                // GIVEN
                                Cake cake = new Cake(Ingredient.VANILLA,4);
                                // WHEN
                                cake.addTopping(Ingredient.SPARKLE);
                                // THEN
                                assertEquals(1, cake.getToppings().size());
                                assertTrue(cake.getToppings().contains(Ingredient.SPARKLE));  ;
                            }
                        </code></pre>
                    </section>

                    <section>
                        <h3>C'est quoi un bon test unitaire ?</h3>
                        <ul>
                            <li class="fragment">Teste qu'UNE chose</li>
                            <li class="fragment">Le plus isol√© possible</li>
                            <li class="fragment">Un assert "simple"</li>
                            <li class="fragment">Comment√©</li>
                            <li class="fragment">Maintenable</li>
                        </ul>
                        <div class="important-bloc fragment">Fait partie du code et est de la documentation </div>
                    </section>

                    <section>
                        <h3>La couverture de test</h3>
                        <ul>
                            <li class="fragment">Indicateur simple √† calculer</li>
                            <li class="fragment">Combien de lignes sont ex√©cut√©es via les tests</li>
                            <li class="fragment">Mais pas tr√®s fiable</li>
                            <li class="fragment">Facile de faire des "faux tests"</li>
                            <li class="fragment">Pr√©f√©rer faire peu de tests utiles que beaucoup inutiles</li>
                            <li class="fragment"><span class="important">80% des probl√®mes viennent de 20% du code</span></li>
                        </ul>
                    </section>

                    <section>
                        <h3>Hands-on 3 üë©‚Äçüíªüë®‚Äçüíª: Tests unitaires</h3>
                        <ul>
                            <li>R√©cup√©rez le code sur git (lien du d√©p√¥t sur moodle, branche code-to-test)</li>
                            <li>Ajoutez la d√©pendance √† Junit5</li>
                            <li>Codez des tests pour toutes les fonctions</li>
                            <li>Lancez vos tests</li>
                            <li>Allez de votre votre couverture de test (target/site/jacoco/index) et am√©liorez la si besoin</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Mutation testing ü¶†</h3>
                        <ul>
                            <li>Les tests permettent d'√©valuer la qualit√© du code</li>
                            <li>Mais qui √©value la qualit√© des tests ?</li>
                            <li>Il est facile de faire de faux test</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Mutation testing : le principe</h3>
                        <ul>
                            <li>Modifier l√©g√®rement le code de l'application (= faire un mutant)
                                <ul>
                                    <li>Changer les bornes des conditions &gt devient &gt;= et inversement</li>
                                    <li>Changer incr√©ment en d√©cr√©ment</li>
                                    <li>Changer les op√©rations math√©matique</li>
                                    <li>...</li>
                                </ul>
                            </li>
                            <li>Lancer les tests qui couvrent le code</li>
                            <li>Si les tests plantent le mutant est tu√©</li>
                            <li>Sinon le mutant s'√©chappe</li>
                            <li>Et on souhaite qu'aucun mutant ne s'√©chappe</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Exemple</h3>
                        <pre><code data-trim class="language-java">
                            if ( i >= 0 ) {
                                return "foo";
                            } else {
                                return "bar";
                            }                            
                        </code></pre>
                        <p>mute en</p>
                        <pre><code data-trim class="language-java">
                            if ( i > 0 ) {
                                return "foo";
                            } else {
                                return "bar";
                            }                            
                        </code></pre>
                        <p>On veux s'assurer qu'au moins un des tests √©choue</p>
                    </section>

                    <section>
                        <h3>Pitest : un framework java</h3>
                        <ul>
                            <li>Compatible Junit4/5</li>
                            <li>Uniquement √† ajouter les d√©pendances dans le pom.xml pour comportement par d√©faut</li>
                            <li>Doc officielle pour plus d'information</li>
                            <li>En python : <a href="https://github.com/boxed/mutmut">mutmut</a>
                                (derni√®re maj 04/11/21)
                                <a href="https://mutatest.readthedocs.io/en/latest/">mutatest</a>(derni√®re maj 16/05/20)
                            </li>
                        </ul>
                    </section>

                    <section>
                        <h3>D√©pendance maven</h3>
                                <pre><code data-trim class="language-xml">
                                    <dependencies>
                                        <dependency>
                                            <groupId>org.pitest</groupId>
                                            <artifactId>pitest-parent</artifactId>
                                            <version>1.7.3</version>
                                            <type>pom</type>
                                        </dependency>       
                                    </dependencies>                  
                                </code></pre>
                    </section>
                            <section>
                                <h3>Configuration du build</h3>
                                <pre><code data-trim class="language-xml">
                            <build>
                                <plugins>
                                    <plugin>
                                        <groupId>org.pitest</groupId>
                                        <artifactId>pitest-maven</artifactId>
                                        <version>1.7.3</version>
                                        <executions>
                                            <execution>
                                                <id>pit-report</id>
                                                <!-- optional, this example attached the goal into mvn test phase -->
                                                <phase>test</phase>
                                                <goals>
                                                    <goal>mutationCoverage</goal>
                                                </goals>
                                            </execution>
                                        </executions>
                                        <dependencies>
                                            <!-- for Juni5 -->
                                            <dependency>
                                                <groupId>org.pitest</groupId>
                                                <artifactId>pitest-junit5-plugin</artifactId>
                                                <version>0.15</version>
                                            </dependency>
                                        </dependencies>
                        
                                    </plugin>    
                                </plugins>
                            </build>                       
                                </code></pre>

                    </section>

                    <section>
                        <h3>Et maintenant ? üéÆ</h3>
                        <ul>
                            <li>Juste √† lancer le goal
                                <pre>
                                    <code data-trim>
                                        mvn test
                                    </code>
                                </pre></li>
                            <li>Allez lire le rapport dans target>pit-reports</li>
                            <li>Modifier ses tests</li>
                        </ul>
                    </section>

                    <section>
                        <img src="img/pit-report-index.png" alt="">
                    </section>
                    <section>
                        <img src="img/pit-report-classes.png" alt="">
                    </section>
                    <section>
                        <img src="img/pit-report-details.png" alt="">
                    </section>

                    <section>
                        <h3>Hands-on 4 ü¶†: mutation testing</h3>
                        <ul>
                            <li>Mettez en place Pitest dans votre projet</li>
                            <li>Regarder combien de mutants s'√©chappent</li>
                            <li>Am√©liorez vos tests pour tous les √©liminer</li>
                        </ul>
                    </section>
    
                    <section>
                        <h3>Une activit√© √† part</h3>
                        <ul>
                            <li class="fragment">Test unitaire : pour le dev</li>
                            <li class="fragment">Les autres : r√¥le du testeur (responsable qualit√©) </li>
                            <li class="fragment">Expertise sur comment mener des tests</li>
                            <li class="fragment">Ind√©pendant de l'√©quipe</li>
                            <li class="fragment">Permet d'√©viter les "faux tests"</li>
                        </ul>
                    </section>
    
    
                    <section>
                        <h3>R√©sum√© des tests</h3>
                        <ul>
                            <li class="fragment">Tester d√©s le d√©but</li>
                            <li class="fragment">Les tests ne sont jamais parfaits</li>
                            <li class="fragment">Mais c'est mieux que rien</li>
                            <li class="fragment">Informe sur la qualit√© de l'application</li>
                            <li class="fragment">Cas nominal/erreur/marge</li>
                            <li class="fragment">Structure GIVEN/WHEN/THEN</li>
    
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Logging üìö</h2>
                    </section>

                    <section>
                        <h3>Logging</h3>
                        <ul>
                            <li>Consiste √† √©mettre et enregistrer des messages suite √† 
                                des √©v√©nement
                            </li>
                            <li>Conna√Ætre l'√©tat d'un objet, un exception lev√©e, arriv√© √† un point du code</li>
                            <li>Facile debug, d√©tection d'anomalie, flux de traitement</li>
                            <li>Fonctionne en production, alors que le debug non</li>
                            <li>Importance proportionnelle √† la taille de l'application</li>
                            <li>Plusieurs API (Log4j java, logging python)</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Logging</h3>
                        <ul>
                            <li>Permet d'avoir la chronologie des √©v√©nements (attention en 
                                cas de multithreading)
                            </li>
                            <li>Peut √™tre persist√© et trait√© par un syst√®me d√©di√©</li>
                            <li>Plusieurs niveau de log</li>
                            <li>Plusieurs sorties possibles</li>
                            <li>Remplace le System.out.println() ou le print()</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Log4j (java)</h3>
                        <ul>
                            <li>Framework populaire java</li>
                            <li>Fiable, rapide, extensible</li>
                            <li>Simple d'utilisation</li>
                            <li>Granularit√© fine</li>
                            <li>COnfiguration au runtime avec fichier de configuration</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Log4j : installation</h3>
                        <pre><code data-trim class="language-xml">
<dependencies>
    <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-api</artifactId>
        <version>2.17.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-core</artifactId>
        <version>2.17.1</version>
    </dependency>
</dependencies>
                        </code></pre>
                    </section>

                    <section>
                        <h3>Log4j architecture</h3>
                        <ul>
                            <li>Loggers : Responsable pour capturer les information de log</li>
                            <li>Appenders : Responsable pour publier les log vers diff√©rentes information</li>
                            <li>Layouts : Responsable pour formater les logs</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Log4j configuration</h3>
                        <ul>
                            <li>Configuration dans le code (statique, difficile √† faire √©voluer, non pr√©sent√©)</li>
                            <li>Configuration dans un fichier (facile √† modifier, surcharger)</li>
                        </ul>
                    </section>

                    <section>
                        <h3>
                            Log4j configuration
                        </h3>
                        <pre><code data-trim class="language-xml">
                            <?xml version="1.0" encoding="UTF-8"?>
                            <Configuration status="WARN">
                                <Appenders>
                                    <Console name="Console" target="SYSTEM_OUT">
                                        <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>
                                    </Console>
                                    <File name="MyFile" fileName="logs/app.log">
                                        <PatternLayout>
                                            <Pattern>%d %p %c{1.} [%t] %m%n</Pattern>
                                        </PatternLayout>
                                    </File>
                                </Appenders>
                                <Loggers>
                                    <Root level="trace">
                                        <AppenderRef ref="Console"/>
                                        <AppenderRef ref="MyFile"/>
                                    </Root>
                                    <Logger name="custom" level="warn">
                                        <AppenderRef ref="Console"/>
                                    </Logger>
                                </Loggers>
                            </Configuration>
                        </code></pre>
                    </section>

                    <section>
                        <h3>Logger</h3>
                        <ul>
                            <li>Responsable de capter les messages</li>
                            <li>On y acc√®de via le code Java</li>
                            <li>Configuration via fichier externe</li>
                            <li>Chaque logger √† un nom (convention java, con.foo.bar.ClassName)</li>
                            <li>H√©ritage possible</li>
                            <li>Priorisation selon le "niveau du message"
                                 (TRACE, DEBUG, INFO, WARN, ERROR, FATAL)</li>
                        </ul>
                    </section>
                    <section>

                    </section>
                    
                    <section>
                        <h3>Appender</h3>
                        <ul>
                            <li>Envoie le message dans la bonne destination</li>
                            <li>Un m√™me logger peut avoir plusieurs appenders</li>
                            <li>Chaque appender √† un layout</li>
                            <li>ConsoleAppender, FileAppender, RollingFileAppender, SMTPAppender, etc</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Layout</h3>
                        <ul>
                            <li>Pour d√©terminer l'affichage des logs</li>
                            <li>HTMLLayout, PatternLayout, SimpleLayout, XMLLayout</li>
                            <li>Pattern Layout : %d %p %c{1.} [%t] %m%n </li>
                            <li>Ajoute de couleur avec highlight{pattern}{style} </li>
                        </ul>
                    </section>

                    <section>
                        <h3>Les bases de Log4j</h3>
                        <ul>
                            <li><span class="fragment">Qui log les messages ?</span><span class="fragment">Les loggers</span></li>
                            <li><span class="fragment">Qui d√©fini le format ? </span><span class="fragment">Les layouts</span></li>
                            <li><span class="fragment">Qui d√©cide la priorit√© des messages ?</span><span class="fragment">Son niveau</span></li>
                            <li><span class="fragment">Qui d√©cide o√π sera envoy√© le message ?</span><span class="fragment">Les appenders</span></li>
                        </ul>
                    </section>
                    <section>
                        <h3>Logger API</h3>
                        <pre><code data-trim class="language-java">
                            import org.apache.logging.log4j.LogManager;
                            import org.apache.logging.log4j.Logger;
                            
                            public class App 
                            {
                                private static Logger logger = LogManager.getRootLogger();
                                public static void main( String[] args )
                                {
                                    logger.trace("msg de trace");
                                    logger.debug("msg de debogage");
                                    logger.info("msg d'info");
                                    logger.warn("msg de warn");
                                    logger.error("msg d'erreur");
                                    logger.fatal("msg fatal");
                                }
                            }
                        </code></pre>                     
                    </section>
                    <section>
                        <h3>Hands-on : mise en place d'un logger üìö</h3>
                        <ol>
                            <li>R√©cup√©rez le code de la partie d'avant</li>
                            <li>Ajoutez diff√©rents loggers
                                <ul>
                                    <li>Un logger qui log tout en console et dans un fichier</li>
                                    <li>Un logger qui log les messages WARN et plus dans un fichier</li>
                                </ul>
                            </li>
                        </ol>
                    </section>

                    <section>
                        <h3>Python logging module</h3>
                        <ul>
                            <li>Logguer n'est pas sp√©cifique √† java</li>
                            <li>Logging : module python de base pour logguer</li>
                            <li>M√™mes principes que log4j, logger, handler, formater, level</li>
                            <li>Configuration par fichier > configuration dans le code</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h3>Python logging module</h3>
                            logging.yml
                                <pre><code data-trim class="language-yml">
                                    version: 1
                                    formatters:
                                      simple:
                                        format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
                                    handlers:
                                      console:
                                        class: logging.StreamHandler
                                        level: DEBUG
                                        formatter: simple
                                        stream: ext://sys.stdout
                                    loggers:
                                      simpleExample:
                                        level: DEBUG
                                        handlers: [console]
                                        propagate: no
                                    root:
                                      level: DEBUG
                                      handlers: [console]
                                </code></pre>
                            </section>
                            <section>
                                    <h3>Python logging module</h3>
                            Fichier python
                                <pre><code data-trim class="language-python">
                                    import logging.config
                                    import yaml
                                    
                                    with open('./logging.yml', 'r') as stream:
                                        config = yaml.load(stream, Loader=yaml.FullLoader)
                                    
                                    logging.config.dictConfig(config)
                                    
                                    # create logger
                                    logger = logging.getLogger('simpleExample')
                                    
                                    # 'application' code
                                    logger.debug('debug message')
                                    logger.info('info message')
                                    logger.warning('warn message')
                                    logger.error('error message')
                                    logger.critical('critical message')
                                </code></pre>   
                    </section>
                </section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
                height: 1080,
                width: 1920,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
